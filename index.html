<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTP Mind in the LLM-Human Loop - 3D Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
            overflow: hidden;
        }

        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #canvas-container {
            width: 100%;
            height: 100%;
        }

        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            max-width: 350px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #info-panel h1 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        #info-panel p {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
            color: #e0e0e0;
        }

        #details-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            max-width: 350px;
            max-height: 400px;
            overflow-y: auto;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        #details-panel h2 {
            font-size: 20px;
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        #details-panel p {
            font-size: 13px;
            line-height: 1.5;
            color: #e0e0e0;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .controls button {
            background: #4fc3f7;
            color: #000;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .controls button:hover {
            background: #81d4fa;
            transform: scale(1.05);
        }

        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .legend h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #4fc3f7;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="loading">Loading 3D Visualization...</div>
        <div id="canvas-container"></div>
        
        <div id="info-panel">
            <h1>INTP Mind Ã— LLM Loop</h1>
            <p>This interactive 3D visualization shows how an INTP's cognitive functions integrate with Large Language Models in the human-AI loop.</p>
            <p><strong>Click</strong> on the colored spheres to learn about each component.</p>
            <p><strong>Drag</strong> to rotate the view.</p>
        </div>

        <div class="legend">
            <h3>Components</h3>
            <div class="legend-item">
                <div class="legend-color" style="background: #9c27b0;"></div>
                <span>Ti - Introverted Thinking</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #2196f3;"></div>
                <span>Ne - Extraverted Intuition</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4caf50;"></div>
                <span>Si - Introverted Sensing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f44336;"></div>
                <span>Fe - Extraverted Feeling</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ffd700;"></div>
                <span>LLM Integration</span>
            </div>
        </div>

        <div class="controls">
            <button id="reset-btn">Reset View</button>
            <button id="animate-btn">Toggle Animation</button>
        </div>

        <div id="details-panel"></div>
    </div>

    <script>
        // 3D Canvas rendering without external dependencies
        let canvas, ctx;
        let cognitiveNodes = [];
        let llmNodes = [];
        let animationEnabled = true;
        let rotation = { x: 0, y: 0 };
        let zoom = 1;
        let isDragging = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        const nodeData = {
            Ti: {
                name: 'Ti - Introverted Thinking',
                position: [0, 3, 0],
                color: 0x9c27b0,
                description: 'Dominant Function: Logical analysis and system understanding. INTPs use Ti to build internal frameworks and models. LLMs enhance this by providing rapid access to information for validation and exploration of logical consistency.',
                llmBenefit: 'LLMs help validate logical frameworks, identify edge cases, and provide alternative theoretical approaches.'
            },
            Ne: {
                name: 'Ne - Extraverted Intuition',
                position: [3, 0, 0],
                color: 0x2196f3,
                description: 'Auxiliary Function: Exploring possibilities and connections. Ne drives INTPs to explore multiple angles and ideas. LLMs accelerate this by offering diverse information sources and suggesting novel connections.',
                llmBenefit: 'LLMs provide endless possibilities for exploration and help INTPs connect disparate concepts across domains.'
            },
            Si: {
                name: 'Si - Introverted Sensing',
                position: [0, -3, 0],
                color: 0x4caf50,
                description: 'Tertiary Function: Recalling past experiences and details. Si stores information and experiences. LLMs can augment this by serving as an external memory bank and helping organize historical data.',
                llmBenefit: 'LLMs act as an extended memory, helping recall and organize information efficiently.'
            },
            Fe: {
                name: 'Fe - Extraverted Feeling',
                position: [-3, 0, 0],
                color: 0xf44336,
                description: 'Inferior Function: Social awareness and harmony. This is the INTP\'s weakest function. LLMs provide crucial support by helping craft appropriate communications and navigate social contexts.',
                llmBenefit: 'LLMs serve as a social buffer, helping INTPs understand emotional contexts and craft appropriate responses.'
            },
            LLM_Input: {
                name: 'LLM: Input Processing',
                position: [0, 0, 4],
                color: 0xffd700,
                description: 'The INTP provides queries, problems, and contexts to the LLM. This is where the INTP\'s questions and intellectual curiosity meet AI capabilities.',
                llmBenefit: 'Gateway for intellectual exploration and problem-solving collaboration.'
            },
            LLM_Output: {
                name: 'LLM: Knowledge Synthesis',
                position: [0, 0, -4],
                color: 0xffd700,
                description: 'The LLM provides synthesized information, alternative perspectives, and structured responses that feed back into the INTP\'s cognitive functions.',
                llmBenefit: 'Delivers insights, validates theories, and accelerates the INTP\'s analytical process.'
            }
        };

        function init() {
            canvas = document.createElement('canvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            ctx = canvas.getContext('2d');
            document.getElementById('canvas-container').appendChild(canvas);

            // Initialize nodes
            initializeNodes();

            // Event listeners
            window.addEventListener('resize', onWindowResize);
            canvas.addEventListener('click', onCanvasClick);
            canvas.addEventListener('mousedown', onMouseDown);
            canvas.addEventListener('mousemove', onMouseMove);
            canvas.addEventListener('mouseup', onMouseUp);
            canvas.addEventListener('wheel', onWheel);

            document.getElementById('reset-btn').addEventListener('click', resetView);
            document.getElementById('animate-btn').addEventListener('click', toggleAnimation);

            document.getElementById('loading').style.display = 'none';
            animate();
        }

        function initializeNodes() {
            Object.keys(nodeData).forEach(key => {
                const data = nodeData[key];
                const isLLM = key.startsWith('LLM');
                
                const node = {
                    key,
                    name: data.name,
                    x: data.position[0],
                    y: data.position[1],
                    z: data.position[2],
                    color: data.color,
                    radius: isLLM ? 0.8 : 0.6,
                    description: data.description,
                    llmBenefit: data.llmBenefit,
                    isLLM
                };

                if (isLLM) {
                    llmNodes.push(node);
                } else {
                    cognitiveNodes.push(node);
                }
            });
        }

        function project3D(x, y, z) {
            // Apply rotation
            let cosX = Math.cos(rotation.x);
            let sinX = Math.sin(rotation.x);
            let cosY = Math.cos(rotation.y);
            let sinY = Math.sin(rotation.y);

            // Rotate around Y axis
            let x1 = x * cosY - z * sinY;
            let z1 = x * sinY + z * cosY;
            
            // Rotate around X axis
            let y1 = y * cosX - z1 * sinX;
            let z2 = y * sinX + z1 * cosX;

            // Perspective projection
            let scale = 300 / (5 + z2);
            scale *= zoom;

            return {
                x: canvas.width / 2 + x1 * scale,
                y: canvas.height / 2 - y1 * scale,
                z: z2,
                scale: scale
            };
        }

        function drawNode(node, time) {
            let x = node.x;
            let y = node.y;
            let z = node.z;

            if (animationEnabled && !node.isLLM) {
                // Rotate cognitive nodes
                const index = cognitiveNodes.indexOf(node);
                const angle = time + (index * Math.PI / 2);
                const radius = 3;
                x = Math.cos(angle) * radius;
                z = Math.sin(angle) * radius;
            }

            const projected = project3D(x, y, z);
            
            if (projected.z < -2) return null; // Behind camera

            const size = node.radius * projected.scale;
            
            // Draw glow
            const gradient = ctx.createRadialGradient(
                projected.x, projected.y, 0,
                projected.x, projected.y, size * 1.5
            );
            const colorStr = '#' + node.color.toString(16).padStart(6, '0');
            gradient.addColorStop(0, colorStr + '88');
            gradient.addColorStop(0.5, colorStr + '44');
            gradient.addColorStop(1, colorStr + '00');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(projected.x, projected.y, size * 1.5, 0, Math.PI * 2);
            ctx.fill();

            // Draw sphere
            const sphereGradient = ctx.createRadialGradient(
                projected.x - size * 0.3, projected.y - size * 0.3, 0,
                projected.x, projected.y, size
            );
            sphereGradient.addColorStop(0, '#ffffff');
            sphereGradient.addColorStop(0.3, colorStr);
            sphereGradient.addColorStop(1, '#000000');
            
            ctx.fillStyle = sphereGradient;
            ctx.beginPath();
            ctx.arc(projected.x, projected.y, size, 0, Math.PI * 2);
            ctx.fill();

            // Draw label
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold ' + Math.max(12, size * 0.4) + 'px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'bottom';
            ctx.fillText(node.name.split(' - ')[0], projected.x, projected.y - size - 10);

            return { projected, size, x, y, z };
        }

        function drawConnection(from, to, color, dashed = false) {
            const p1 = project3D(from.x, from.y, from.z);
            const p2 = project3D(to.x, to.y, to.z);

            if (p1.z < -2 || p2.z < -2) return;

            ctx.strokeStyle = '#' + color.toString(16).padStart(6, '0') + (dashed ? '55' : '88');
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            if (dashed) {
                ctx.setLineDash([5, 5]);
            }
            
            ctx.moveTo(p1.x, p1.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        let time = 0;
        function animate() {
            requestAnimationFrame(animate);

            // Clear canvas
            ctx.fillStyle = '#0a0e27';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (animationEnabled) {
                time += 0.01;
            }

            // Store positions for connections
            const positions = [];

            // Draw connections first (behind nodes)
            const cogPositions = cognitiveNodes.map((node, i) => {
                const angle = time + (i * Math.PI / 2);
                const radius = 3;
                return {
                    x: animationEnabled ? Math.cos(angle) * radius : node.x,
                    y: node.y,
                    z: animationEnabled ? Math.sin(angle) * radius : node.z
                };
            });

            // Cognitive loop connections
            for (let i = 0; i < cogPositions.length; i++) {
                const next = (i + 1) % cogPositions.length;
                const colors = [0x9c27b0, 0x2196f3, 0x4caf50, 0xf44336];
                drawConnection(cogPositions[i], cogPositions[next], colors[i]);
            }

            // LLM connections
            const llmInPos = { x: llmNodes[0].x, y: llmNodes[0].y, z: llmNodes[0].z };
            const llmOutPos = { x: llmNodes[1].x, y: llmNodes[1].y, z: llmNodes[1].z };

            drawConnection(llmInPos, cogPositions[0], 0xffd700, true);
            drawConnection(llmInPos, cogPositions[1], 0xffd700, true);
            
            cogPositions.forEach(pos => {
                drawConnection(pos, llmOutPos, 0xffd700, true);
            });

            drawConnection(llmInPos, llmOutPos, 0xffd700);

            // Draw nodes
            const allNodes = [...cognitiveNodes, ...llmNodes];
            const drawnNodes = [];
            
            allNodes.forEach(node => {
                const result = drawNode(node, time);
                if (result) {
                    drawnNodes.push({ node, ...result });
                }
            });

            // Sort by z-index and store for click detection
            drawnNodes.sort((a, b) => a.projected.z - b.projected.z);
            window.drawnNodes = drawnNodes;
        }

        function onMouseDown(e) {
            isDragging = true;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        }

        function onMouseMove(e) {
            if (isDragging) {
                const deltaX = e.clientX - lastMouseX;
                const deltaY = e.clientY - lastMouseY;

                rotation.y += deltaX * 0.005;
                rotation.x += deltaY * 0.005;

                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            }
        }

        function onMouseUp() {
            isDragging = false;
        }

        function onWheel(e) {
            e.preventDefault();
            zoom *= (1 - e.deltaY * 0.001);
            zoom = Math.max(0.5, Math.min(2, zoom));
        }

        function onCanvasClick(e) {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            if (!window.drawnNodes) return;

            // Check from front to back
            for (let i = window.drawnNodes.length - 1; i >= 0; i--) {
                const { node, projected, size } = window.drawnNodes[i];
                const dx = mouseX - projected.x;
                const dy = mouseY - projected.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < size) {
                    showDetails({
                        name: node.name,
                        description: node.description,
                        llmBenefit: node.llmBenefit
                    });
                    break;
                }
            }
        }

        function showDetails(data) {
            const panel = document.getElementById('details-panel');
            panel.innerHTML = `
                <h2>${data.name}</h2>
                <p><strong>Description:</strong> ${data.description}</p>
                <p><strong>LLM Benefit:</strong> ${data.llmBenefit}</p>
            `;
            panel.style.display = 'block';
        }

        function resetView() {
            rotation = { x: 0, y: 0 };
            zoom = 1;
        }

        function toggleAnimation() {
            animationEnabled = !animationEnabled;
        }

        function onWindowResize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        // Initialize
        init();
    </script>
</body>
</html>
